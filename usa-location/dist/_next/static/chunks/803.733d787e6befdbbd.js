"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[803],{6803:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var r=n(5155),o=n(2115);function a(e){let{profiles:t,onProfileSelect:a}=e,c=(0,o.useRef)(null),s=(0,o.useRef)(null),i=(0,o.useRef)([]),[l,d]=(0,o.useState)(null),p=[39.8283,-98.5795],u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.divIcon({html:'\n        <div style="\n          background: '.concat(n?"#dc2626":"#3b82f6",";\n          color: white;\n          border: 2px solid white;\n          border-radius: 50%;\n          width: 32px;\n          height: 32px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-weight: bold;\n          font-size: 12px;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n          ").concat(n?"transform: scale(1.2);":"",'\n        ">\n          ').concat(t+1,"\n        </div>\n      "),className:"custom-marker",iconSize:[32,32],iconAnchor:[16,16]})},g=async(e,n)=>{try{i.current.forEach(e=>{try{n.removeLayer(e)}catch(e){}}),i.current=[];let r=[];if(t.forEach((t,o)=>{try{let c=e.marker([t.address.coordinates.lat,t.address.coordinates.lng],{icon:u(e,o,l===t)}),s='\n            <div style="padding: 8px; min-width: 200px;">\n              <div style="display: flex; align-items: center; margin-bottom: 8px;">\n                <div style="background: #2563eb; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; margin-right: 8px;">\n                  '.concat(o+1,'\n                </div>\n                <h5 style="font-weight: 600; color: #111827; font-size: 14px; margin: 0;">').concat(t.personal.fullName,'</h5>\n              </div>\n              <div style="font-size: 12px; color: #4b5563; line-height: 1.4;">\n                <p style="margin: 4px 0;"><strong>地址:</strong> ').concat(t.address.street,'</p>\n                <p style="margin: 4px 0;"><strong>城市:</strong> ').concat(t.address.city,", ").concat(t.address.stateAbbreviation," ").concat(t.address.zipCode,'</p>\n                <p style="margin: 4px 0;"><strong>坐标:</strong> ').concat(t.address.coordinates.lat.toFixed(4),", ").concat(t.address.coordinates.lng.toFixed(4),'</p>\n                <p style="margin: 4px 0;"><strong>电话:</strong> ').concat(t.personal.phone,'</p>\n                <p style="margin: 4px 0;"><strong>邮箱:</strong> ').concat(t.personal.email,"</p>\n              </div>\n            </div>\n          ");c.bindPopup(s,{maxWidth:300,className:"custom-popup"}),c.on("click",()=>{let e=l===t?null:t;d(e),a&&a(e)}),c.addTo(n),r.push(c)}catch(e){console.error("添加标记失败:",e)}}),i.current=r,r.length>0)try{let t=new e.featureGroup(r);n.fitBounds(t.getBounds().pad(.1))}catch(e){console.error("调整地图视图失败:",e)}}catch(e){console.error("更新标记失败:",e)}};return(0,o.useEffect)(()=>{if(c.current&&!s.current)return(async()=>{try{let e=await n.e(761).then(n.t.bind(n,5752,23));delete e.Icon.Default.prototype._getIconUrl,e.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});let r=e.map(c.current,{center:p,zoom:4,zoomControl:!0,scrollWheelZoom:!0,doubleClickZoom:!0,dragging:!0});e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19,minZoom:3}).addTo(r),s.current=r,setTimeout(()=>{r.invalidateSize(),t.length>0&&g(e,r)},100)}catch(e){console.error("地图初始化失败:",e)}})(),()=>{s.current&&(s.current.remove(),s.current=null)}},[t]),(0,o.useEffect)(()=>{s.current&&(async()=>{try{let e=await n.e(761).then(n.t.bind(n,5752,23)),t=s.current;await g(e,t)}catch(e){console.error("更新标记失败:",e)}})()},[t,l,a]),(0,r.jsx)("div",{ref:c,style:{height:"100%",width:"100%"},className:"leaflet-container"})}}}]);